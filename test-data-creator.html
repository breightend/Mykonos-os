<!doctype html>
<html>
  <head>
    <title>Test Data Creation</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 50px auto;
        padding: 20px;
      }
      .button {
        background-color: #4caf50;
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 4px;
      }
      .button:hover {
        background-color: #45a049;
      }
      .status {
        margin-top: 20px;
        padding: 10px;
        border-radius: 4px;
      }
      .success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
    </style>
  </head>
  <body>
    <h1>Purchase Management System - Test Data</h1>
    <p>
      Click the button below to create sample data for testing the purchase management component:
    </p>

    <button id="createDataBtn" class="button">Create Sample Data</button>
    <button id="testApiBtn" class="button" style="background-color: #2196f3">
      Test API Connection
    </button>

    <div id="status"></div>

    <script>
      const API_BASE_URL = 'http://localhost:5000/api/purchases'

      async function createSampleData() {
        const statusDiv = document.getElementById('status')
        const btn = document.getElementById('createDataBtn')

        try {
          btn.disabled = true
          btn.textContent = 'Creating...'
          statusDiv.innerHTML = '<div class="status">Creating sample data...</div>'

          const response = await fetch(`${API_BASE_URL}/create-sample-data`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            }
          })

          const result = await response.json()

          if (response.ok) {
            statusDiv.innerHTML = `<div class="status success">✅ ${result.message}</div>`
          } else {
            statusDiv.innerHTML = `<div class="status error">❌ Error: ${result.message}</div>`
          }
        } catch (error) {
          statusDiv.innerHTML = `<div class="status error">❌ Network Error: ${error.message}</div>`
        } finally {
          btn.disabled = false
          btn.textContent = 'Create Sample Data'
        }
      }

      async function testApiConnection() {
        const statusDiv = document.getElementById('status')
        const btn = document.getElementById('testApiBtn')

        try {
          btn.disabled = true
          btn.textContent = 'Testing...'
          statusDiv.innerHTML = '<div class="status">Testing API connection...</div>'

          const response = await fetch(`${API_BASE_URL}/summary`)
          const result = await response.json()

          if (response.ok) {
            statusDiv.innerHTML = `
                        <div class="status success">
                            ✅ API Connection Successful!<br>
                            <strong>Current Data:</strong><br>
                            Total Purchases: ${result.summary?.total_purchases || 0}<br>
                            Total Amount: $${result.summary?.total_amount || 0}<br>
                            Pending: ${result.summary?.pending_purchases || 0}<br>
                            Received: ${result.summary?.received_purchases || 0}
                        </div>
                    `
          } else {
            statusDiv.innerHTML = `<div class="status error">❌ API Error: ${result.message || 'Unknown error'}</div>`
          }
        } catch (error) {
          statusDiv.innerHTML = `<div class="status error">❌ Network Error: ${error.message}<br>Make sure the backend server is running on http://localhost:5000</div>`
        } finally {
          btn.disabled = false
          btn.textContent = 'Test API Connection'
        }
      }

      document.getElementById('createDataBtn').addEventListener('click', createSampleData)
      document.getElementById('testApiBtn').addEventListener('click', testApiConnection)
    </script>
  </body>
</html>
